% ! TeX root = ../../thesis.tex
\chapter{Validazione, conclusioni e lavori futuri}
\label{chapter:validation}
In questo capitolo vengono riportati e analizzati i risultati ottenuti nell'ambito di applicazione dello strumento sviluppato.

\section{Valutazione qualitativa}
Le prestazioni del sistema sono misurate sulla base di due aspetti fondamentali e indipendenti tra loro: le \textit{performance}, in termini di tempo d'esecuzione, ma soprattutto l'accuratezza.
%
Infatti, lo scopo primario è rilevare con precisione casi probabili di plagio e presentarli all'utente il più in alto possibile nei \textit{report} generati dallo strumento.
%
\`E solo in seguito ad aver raggiunto un grado di precisione soddisfacibile che possono essere adottate ottimizzazioni che permettano di ridurre il tempo di calcolo.

Dunque, per testarne l'accuratezza sono stati considerati 130 diversi progetti del corso di Programmazione ad Oggetti presentati nell'arco degli ultimi tre anni accademici e per ciascuno di questi si è effettuato il confronto con tutti i progetti a disposizione dal 2015 in poi che, complessivamente, ammontano a 354 progetti.
%
Questi sono sviluppati in Java, generalmente in \textit{team} di quattro componenti, e rappresentano artefatti di medio-alta complessità, costituiti in media da più di un centinaio di sorgenti ciascuno.

\subsection{Analisi di sensitività}
Dapprima si è testato il sistema eseguendo una scansione senza applicare alcun filtraggio intermedio delle rappresentazioni come descritto nella \Cref{03:filtering-phase}, scegliendo come parametri di riferimento i seguenti:
\begin{itemize}
    \item $s$, minima lunghezza della sequenza di \textit{token} rilevabile dall'algoritmo di \textit{detection} (\textit{RKR-GST}) pari a 15;
    \item valore di soglia percentuale sotto la quale la similarità di una coppia di sorgenti non viene segnalata pari al 30\%;
    \item metrica espressa dall'\Cref{eq:avg-norm-sim}.
\end{itemize}

A seguito dell'analisi si è effettuata un'ispezione manuale dei sorgenti in modo tale da verificare che le stime effettuate dallo strumento non fossero fuorvianti o prive di fondamento.

I risultati complessivi sono presentati in \Cref{table:results}; per semplicità sono riportati solo le corrispondenze con similarità maggiore del 40\%.

\begin{table}[h!]
    \centering
    \begin{tabular}{|p{0.2\linewidth}|p{0.2\linewidth}|p{0.15\linewidth}|p{0.35\textwidth}|}
        \hline
        \textbf{Progetto originale} & \textbf{Progetto copiato} & \textbf{Similarità} & \textbf{Ispezione manuale} \\ [0.5ex] 
        \hline\hline
        gym-man & gym-man & 100\% & corrispondenza totale \\
        \hline
        spacewar & Space-Invaders & 90\% & corrispondenza totale \\
        \hline
        zombiegame & boxhead & 81\% & corrispondenza elevata \\
        \hline
        paranoid & b.b.evo & 70\% & corrispondenza medio-alta \\
        \hline
        space-run & alone-in-the-space & 62\% & corrispondenza medio-alta \\
        \hline
        Flappy Bird & SMR & 55\% & corrispondenza parziale \\
        \hline
        Teatro & harbor-mgr & 49\% & corrispondenza parziale \\
        \hline
        ALA & traffic-sim & 48\% & nessuna corrispondenza - "falso positivo" \\
        \hline
    \end{tabular}
    \caption[Risultati ottenuti confrontando i progetti sottomessi negli ultimi tre anni accademici]{Risultati ottenuti confrontando i progetti consegnati negli ultimi tre anni accademici. Nell'ultima colonna vi è riportato l'esito dell'ispezione manuale eseguita a seguito di quella automatica; per semplicità si sono catalogate le corrispondenze in: corrispondenza \textit{totale}, \textit{elevata}, \textit{parziale} o \textit{falso positivo}.}
    \label{table:results}
\end{table}

Come si può osservare, lo strumento è in grado di rilevare molto bene copiature evidenti, ovvero casi in cui sono state copiate intere classi di sorgenti: è il caso dei primi due risultati in cui i progetti sono pressoché identici e la percentuale di similarità stimata non è inferiore al 90\%.
%
Nel secondo caso la similarità al 90\% è spiegabile dal fatto che alcune interfacce sono molto piccole e non hanno una lunghezza (in numero di \textit{token}) sufficiente per essere rilevate (cioè sono minori della minima lunghezza $s$ imposta nell'algoritmo \textit{Running Karp Rabin Greedy String Tiling}).

Come naturale che sia, invece, laddove la copiatura è effettuata in modo più scaltro, attingendo in modo parziale da altri progetti, la similarità cala, mantenendosi tuttavia al di sopra del 60\%.

Sotto il 60\% si è in presenza di codice piuttosto simile, ma in maniera molto limitata rispetto alla totalità dei sorgenti.
%
\`E il caso, ad esempio, dei progetti \texttt{SMR} e \texttt{Flappy Bird} in cui è intuibile, guardando i risultati generati dal rilevatore, che gli sviluppatori del secondo abbiano preso spunto dal primo.
%
Tuttavia non è ravvisabile una copiatura evidente come nei precedenti casi.

Un solo caso, tra tutti i progetti analizzati, riporta similarità maggiore del 45\% senza essere realmente copiato.
%
Ciononostante, la similarità riportata non è superiore al 50\% e il fatto che i progetti non siano copiati né simili è facilmente verificabile in pochi minuti guardando il \textit{report} stesso che comprende solo costanti e \textit{getter/setter}.

Successivamente, al fine di verificare la combinazione ottimale di parametri da utilizzare, sono state rieffettuate le scansioni dei soli progetti somiglianti presentati in \Cref{table:results}, facendoli opportunamente variare.
%
Come si può notare dalla \Cref{table:grid-search} le misurazioni di similarità più accurate in relazione all'ispezione manuale riportata in \Cref{table:results} sono in corrispondenza di una lunghezza\dots

Si noti che la misurazione della similarità mediante l'\Cref{eq:max-norm-sim} in concomitanza con quella dei progetti (\Cref{eq:project-similarity}) genera risultati fuorvianti in corrispondenza di piccoli progetti e/o sorgenti di piccola dimensione.
%
Questo fenomeno è facilmente osservabile dalle stime di similarità tra i progetti \texttt{Flappy-bird} e \texttt{SMR}. 
%
Questo ci spinge a preferire l'utilizzo della metrica descritta nell'\Cref{eq:max-norm-sim} piuttosto che...

\begin{landscape}
    \begin{table}[h!]
        \centering
        \begin{tabular}{ c|c|c|p{1cm}|p{1.5cm}|p{2cm}|p{1.5cm}|p{1.5cm}|p{1.5cm}|p{1.5cm}|p{1.2cm} }
            \multicolumn{3}{c|}{} & gym-man / gym-man & spacewar / space-invaders & zombiegame / boxhead & paranoid / b.b.evo & Space-run / alone-in-the-space & flappy-bird / SMR & Teatro / harbor-mgr & ALA / traffic-sim \\ [0.5ex]
            \hline\hline
            \multirow{6}{*}{$\text{min-dup}=0.3$} & \multirow{2}{*}{$s=15$} & Max & 100\% & 95\% & 72\% & 72\% & 75\% & 80\% & 56\% & 74\% \\
            & & Avg & 100\% & 90\% & 81\% & 70\% & 62\% & 55\% & 49\% & 48\% \\
            & \multirow{2}{*}{$s=20$} & Max & 100\% & 99\% & 72\% & 75\% & 63\% & 83\% & 50\% & 57\% \\
            & & Avg & 100\% & 91\% & 58\% & 71\% & 48\% & 61\% & 51\% & 31\% \\
            & \multirow{2}{*}{$s=25$} & Max & 100\% & 98\% & 54\% & 66\% & 49\% & 79\% & 46\% & 26\% \\
            & & Avg & 100\% & 92\% & 42\% & 58\% & 41\% & 51\% & 40\% & 12\% \\
            \hline

            \multirow{6}{*}{$\text{min-dup}=0.4$} & \multirow{2}{*}{$s=15$} & Max & 100\% & 96\% & 81\% & 76\% & 70\% & 79\% & 61\% & 75\% \\
            & & Avg & 100\% & 92\% & 73\% & 79\% & 57\% & 62\% & 55\% & 22\% \\
            & \multirow{2}{*}{$s=20$} & Max & 100\% & 99\% & 65\% & 85\% & 63\% & 80\% & 57\% & 47\% \\
            & & Avg & 100\% & 97\% & 49\% & 69\% & 44\% & 54\% & 39\% & 10\% \\
            & \multirow{2}{*}{$s=25$} & Max & 100\% & 99\% & 49\% & 64\% & 42\% & 80\% & 46\% & 64\% \\
            & & Avg & 100\% & 99\% & 36\% & 62\% & 34\% & 52\% & 20\% & 6\% \\
            \hline

            \multirow{6}{*}{$\text{min-dup}=0.5$} & \multirow{2}{*}{$s=15$} & Max & 100\% & 99\% & 80\% & 84\% & 64\% & 76\% & 67\% & 27\% \\
            & & Avg & 100\% & 99\% & 51\% & 73\% & 33\% & 52\% & 33\% & 14\% \\
            & \multirow{2}{*}{$s=20$} & Max & 100\% & 99\% & 56\% & 82\% & 59\% & 56\% & 45\% & 35\% \\
            & & Avg & 100\% & 99\% & 30\% & 67\% & 30\% & 47\% & 23\% & 4\% \\
            & \multirow{2}{*}{$s=25$} & Max & 100\% & 99\% & 44\% & 63\% & 38\% & 56\% & 27\% & 15\% \\
            & & Avg & 100\% & 98\% & 21\% & 55\% & 27\% & 47\% & 11\% & 3\% \\
            \hline
        \end{tabular}
        \caption[]{}
        \label{table:grid-search}
    \end{table}
\end{landscape}

Si è infine testato il risultato dell'analisi eseguendo il filtraggio delle rappresentazioni come descritto nella \Cref{03:filtering-phase}.

\begin{table}[h!]
    \centering
    \begin{tabular}{|c|c|c|c|c|}
        \hline
        \diagbox{\textbf{Progetti}}{\textbf{Soglia filtro}} & \textbf{assente} & \textbf{0,3} & \textbf{0,4} & \textbf{0,5} \\ [0.5ex] 
        \hline\hline
        gym-man - gym-man & 100\% & 100\% & 100\% & 100\% \\
        \hline
        spacewar - Space-Invaders & 90\% & 90\% & 90\% & 90\% \\
        \hline
        zombiegame - boxhead & 81\% & 81\% & 81\% & 80\% \\
        \hline
        paranoid - b.b.evo & 70\% & 70\% & 70\% & 78\% \\
        \hline
        space-run - alone-in-the-space & 62\% & 62\% & 62\% & 59\% \\
        \hline
        Flappy Bird - SMR & 55\% & 55\% & 55\% & 55\% \\
        \hline
        Teatro - harbor-mgr & 49\% & 49\% & 49\% & 49\% \\
        \hline
        ALA - traffic-sim & 48\% & 48\% & 48\% & 46\% \\
        \hline
    \end{tabular}
    \caption{}
    \label{table:filter-results}
\end{table}

\subsection{Analisi di sensibilità}

\section{Tempi d'esecuzione}
Per quanto concerne i tempi d'esecuzione, attualmente lo strumento impiega, per fare il confronto di un progetto con i 354 progetti disponibili, grazie alla parallelizzazione e al salvataggio in locale dei sorgenti da analizzare, mediamente un terzo del tempo che avrebbe impiegato senza effettuare il \textit{caching}, stimabile all'incirca in al più 20 minuti.
%
Questo dipende anche in maniera incontrollabile dal calcolatore su cui viene eseguito.

\section{Conclusioni}

\section{Sviluppi futuri}
